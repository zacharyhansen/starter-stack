{"version":3,"sources":["../../src/query/query.router.ts"],"sourcesContent":["import { Input, Query, Router } from 'nestjs-trpc';\nimport { z } from 'zod';\nimport { Inject } from '@nestjs/common';\nimport { sql } from 'kysely';\n\nimport { QueryService } from './query.service';\n\nimport { Database } from '~/database/database';\n\n@Router({ alias: 'query' })\nexport class QueryRouter {\n  constructor(\n    @Inject(QueryService) private queryService: QueryService,\n    @Inject(Database) private readonly database: Database\n  ) {}\n\n  @Query({\n    input: z.object({ query: z.string() }),\n    output: z.any(),\n  })\n  async execute(@Input('query') query: string) {\n    return this.queryService.execute({\n      query: sql.raw(query).compile(this.database),\n    });\n  }\n}\n"],"names":["QueryRouter","constructor","queryService","database","execute","query","sql","raw","compile","input","z","object","string","output","any","alias"],"mappings":";;;;+BAUaA;;;eAAAA;;;4BAVwB;qBACnB;wBACK;wBACH;8BAES;0BAEJ;;;;;;;;;;;;;;;AAGlB,IAAA,AAAMA,cAAN,MAAMA;IACXC,YACE,AAA8BC,YAA0B,EACxD,AAAmCC,QAAkB,CACrD;aAF8BD,eAAAA;aACKC,WAAAA;IAClC;IAEH,MAIMC,QAAQ,AAAgBC,KAAa,EAAE;QAC3C,OAAO,IAAI,CAACH,YAAY,CAACE,OAAO,CAAC;YAC/BC,OAAOC,WAAG,CAACC,GAAG,CAACF,OAAOG,OAAO,CAAC,IAAI,CAACL,QAAQ;QAC7C;IACF;AACF;;;QARIM,OAAOC,MAAC,CAACC,MAAM,CAAC;YAAEN,OAAOK,MAAC,CAACE,MAAM;QAAG;QACpCC,QAAQH,MAAC,CAACI,GAAG;;;;;;;;;;;QATPC,OAAO"}