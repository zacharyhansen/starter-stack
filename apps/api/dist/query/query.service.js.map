{"version":3,"sources":["../../src/query/query.service.ts"],"sourcesContent":["import { Inject, Injectable } from '@nestjs/common';\nimport type { CompiledQuery } from 'kysely';\nimport type { Pool } from 'pg';\n\nimport { Database } from '~/database/database';\n\n@Injectable()\nexport class QueryService {\n  constructor(\n    @Inject(Database) private readonly database: Database,\n    @Inject('PoolReadOnly') private readonly poolReadOnly: Pool\n  ) {}\n\n  async execute<T extends unknown[] = unknown[]>({\n    query,\n  }: {\n    query: CompiledQuery;\n  }) {\n    return await this.poolReadOnly.query<T>(\n      {\n        rowMode: 'array',\n        text: query.sql,\n      },\n      query.parameters as unknown[]\n    );\n  }\n}\n"],"names":["QueryService","constructor","database","poolReadOnly","execute","query","rowMode","text","sql","parameters"],"mappings":";;;;+BAOaA;;;eAAAA;;;wBAPsB;0BAIV;;;;;;;;;;;;;;;AAGlB,IAAA,AAAMA,eAAN,MAAMA;IACXC,YACE,AAAmCC,QAAkB,EACrD,AAAyCC,YAAkB,CAC3D;aAFmCD,WAAAA;aACMC,eAAAA;IACxC;IAEH,MAAMC,QAAyC,EAC7CC,KAAK,EAGN,EAAE;QACD,OAAO,MAAM,IAAI,CAACF,YAAY,CAACE,KAAK,CAClC;YACEC,SAAS;YACTC,MAAMF,MAAMG,GAAG;QACjB,GACAH,MAAMI,UAAU;IAEpB;AACF"}